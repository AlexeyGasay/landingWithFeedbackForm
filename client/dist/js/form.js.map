{"version":3,"sources":["form.js"],"names":["form","document","querySelector","sendBtn","getElementById","formInputs","element","length","i","push","validEmail","e","classList","value","target","name","remove","numberOfInputs","match","sendData","body","correctInputs","alert","email","subject","message","headers","then","json","addEventListener","validate","fetch","JSON","stringify","method","Content-Type","res","status"],"mappings":"aAQA,IALA,IAAIA,KAAOC,SAASC,cAAc,QAC9BC,QAAUF,SAASG,eAAe,sBAElCC,WAAa,GAGTC,EAAO,EAAGN,EAAIA,KAApBO,OAAAC,IAAA,CAAA,IAAMF,QAAUN,KAAKQ,GAInBH,QAAWI,UAAKH,SAAhB,yBAGHD,WAAAI,KAAAH,SAGD,IAAII,YAAa,EAGjB,SASOC,SAASC,GAPd,IAAIC,EAAQF,EAAEG,OAAOD,MAYfA,GAAQE,EAPZJ,EAWEA,OAAEG,UAAOF,IAAUI,gBAFrBL,EAAAG,OAKKF,UAAAI,OAAA,gBAST,SAAAL,EAAAG,OAAAC,OAIME,WAlBGJ,EAAMK,MAQV,8BAQHP,EAAAG,OAAAF,UAAAI,OAAA,iBAEIC,IAIJN,EAAKG,OAAKF,UAAUP,IAAAA,iBACFA,IARpB,SAkBSc,WAXP,IAJA,IAAIF,EAAiBZ,WAAWE,OAqB5Ba,EAAO,EAGFZ,EAHE,EAAAA,EAAAH,WAAAE,OAAAC,IAAA,CAdmB,EAkBnBH,WAAAG,GAlBIK,MAAMN,SAsBnBc,GAAgBhB,GAhBlB,IAAKK,YAoBaJ,GAAZW,EAhBD,OAAOK,MAAO,iBAFjBA,MAoBO,iBAPT,IAPA,IAoBIF,EAAK,CAnBPL,KAoBIK,GAXJG,MAAA,GAeDC,QAAA,GArBCC,QAAS,IAyBHjB,EAAE,EAFqCA,EAAAH,WAAAE,OAAAC,IAAA,CAG7CkB,IAAAA,EAASrB,WAAAG,GAAA,OAAAF,EAAAS,MAIVY,IAAK,OACAC,EAAJb,KAAAT,EAAAO,MAEA,IAAQ,QAENS,EAAMC,MAAAjB,EAAAO,MAZV,IAAA,UAiBDO,EAAAI,QAAAlB,EAAAO,MAIIgB,IAAAA,UACAA,EAAAA,QAAiBvB,EAASwB,OAtB7BC,MAAM,wCAAyC,CAC7CX,KAAMY,KAAKC,UAAUb,GACrBc,OAAQ,OACRR,QAAS,CACPS,eAAgB,sBAGnBR,KAAK,SAAAS,GACJA,EAAIR,OAEe,KAAdQ,EAAIC,QAEPf,MAAM,yCASZtB,KAAK6B,iBAAiB,QAASC,UAC/B9B,KAAK6B,iBAAiB,QAASC,UAE/B3B,QAAQ0B,iBAAiB,QAASV","file":"form.js","sourcesContent":["\r\n// ВАЛИДАЦИЯ\r\n\r\nlet form = document.querySelector(\"form\"); \r\nlet sendBtn = document.getElementById(\"feedback__send_btn\");\r\n\r\nlet formInputs = [];\r\n\r\nfor (let i = 0; i < form.length; i++) {\r\n  const element = form[i];\r\n  \r\n  if ( element.classList.contains(\"feedback__form_input\") )\r\n  {\r\n    formInputs.push(element);\r\n  }\r\n \r\n}\r\n\r\n\r\nlet validEmail = false;\r\n\r\n\r\nfunction validate(e) {\r\n\r\n  let value = e.target.value;\r\n\r\n  // EMPTY CHECK\r\n  if ( value <= 0 ) \r\n  {\r\n    e.target.classList.add('invalid_data');\r\n  }\r\n  else e.target.classList.remove('invalid_data');\r\n\r\n  // EMAIL CHECK\r\n  let emailPattern = /^[^ ]+@[^ ]+\\.[a-z]{2,3}$/;\r\n\r\n  if ( e.target.name == \"email\" ) \r\n  {\r\n    if ( value.match(emailPattern) ) \r\n    {\r\n      e.target.classList.remove('invalid_data');\r\n      validEmail = true;\r\n    }\r\n    else {\r\n      e.target.classList.add('invalid_data');\r\n      validEmail = false\r\n    }\r\n  }\r\n\r\n}\r\n\r\n\r\n// ОТПРАВКА ДАННЫХ\r\nfunction sendData() {\r\n  // FULL CHECK\r\n\r\n  let numberOfInputs = formInputs.length;\r\n  let correctInputs = 0;\r\n  \r\n\r\n  for (let i = 0; i < formInputs.length; i++) {\r\n    const element = formInputs[i];\r\n\r\n    if ( element.value.length > 0 )\r\n    {\r\n      correctInputs += 1\r\n    }\r\n\r\n  }\r\n  if ( validEmail && correctInputs == numberOfInputs )\r\n  {\r\n    alert( 'Все в порядке' )\r\n  }\r\n  else return alert( 'Что-то не так' )\r\n\r\n\r\n  // SEND DATA \r\n  let body = {\r\n    name: \"\",\r\n    email: \"\",\r\n    subject: \"\",\r\n    message: \"\"\r\n  };\r\n\r\n  for (let i = 0; i < formInputs.length; i++) {\r\n    const element = formInputs[i];\r\n\r\n    switch (element.name) {\r\n      case \"name\":\r\n        body.name = element.value;\r\n\r\n      case \"email\":\r\n        body.email = element.value;\r\n\r\n      case \"subject\":\r\n        body.subject = element.value;\r\n\r\n      case \"message\":\r\n        body.message = element.value;\r\n      \r\n    }\r\n    \r\n  }\r\n\r\n  fetch(\"http://localhost:4000/api/application\", {\r\n    body: JSON.stringify(body),\r\n    method: \"POST\",\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    }\r\n  })\r\n  .then(res => {\r\n    res.json();\r\n\r\n    if ( res.status == 400 ) \r\n    {\r\n      alert(\"Заявка с таким email уже существует\")\r\n    }\r\n\r\n  })\r\n\r\n}\r\n\r\n\r\n\r\nform.addEventListener(\"input\", validate);\r\nform.addEventListener(\"click\", validate);\r\n\r\nsendBtn.addEventListener(\"click\", sendData);"]}